# -*- Tcl -*-

package require tcltest 2.2
namespace import -force ::tcltest::*

::tcltest::configure {*}$argv

if {[ns_config test listenport] ne ""} {
    testConstraint serverListen true
}

#
# Check configured tclsh from configuration file and set test
# constraint based on this.
#
set tclsh [ns_config ns/interps/CGIinterps .cgi]
testConstraint tclsh [expr {$tclsh ne ""}]

test nscgi-1.0 {basic request} -constraints {serverListen tclsh} -body {
    nstest::http -http 1.1 -getbody 1 GET /hello.cgi
} -returnCodes {error ok} -match glob -result {*You are using NaviServer*}



cleanupTests

# Local variables:
#    mode: tcl
#    tcl-indent-level: 4
#    indent-tabs-mode: nil
# End:
